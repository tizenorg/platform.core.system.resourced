


SET(PROJECT ${RESOURCED})

INCLUDE_DIRECTORIES(${INCLUDE_PUBLIC_DIR}
		${DATAUSAGE_SOURCE_DIR}/include
		${NETWORK_SOURCE_DIR}/include
		${RESOURCED_INCLUDEDIR}
	)

INCLUDE(FindPkgConfig)
pkg_check_modules(pkgs_${NETWORK} REQUIRED dlog
				       glib-2.0
				       sqlite3
				       vconf
				       ecore)

FOREACH(flag ${pkg_${NETWORK}_CFLAGS})
    SET(EXTRA_CFLAGS "${EXTRA_CFLAGS} ${flag}")
ENDFOREACH(flag)

SET(CMAKE_C_FLAGS "${CMAKE_C_FLAGS} ${EXTRA_CFLAGS} -fPIC -Wall -Werror")
SET(CMAKE_C_FLAGS_DEBUG "-O0 -g")

IF("${ARCH}" STREQUAL "arm")
    ADD_DEFINITIONS("-DTARGET")
ENDIF("${ARCH}" STREQUAL "arm")

ADD_DEFINITIONS("-DPREFIX=\"${CMAKE_INSTALL_PREFIX}\"")
ADD_DEFINITIONS("-DSLP_DEBUG")

SET(SOURCES
	${NETWORK_SOURCE_DIR}/network.c)

ADD_LIBRARY(${NETWORK} SHARED ${SOURCES})
ADD_DEPENDENCIES(${NETWORK} ${PROJECT})
TARGET_LINK_LIBRARIES(${NETWORK} ${${NETWORK}_LDFLAGS} -L${LIBRARY_OUTPUT_PATH} -l${PROJECT})

SET_TARGET_PROPERTIES(${NETWORK}
     PROPERTIES
     VERSION ${FULLVER}
     SOVERSION ${MAJORVER}
     CLEAN_DIRECT_OUTPUT 1
)

INSTALL(TARGETS ${NETWORK} DESTINATION ${CMAKE_INSTALL_PREFIX}/lib)
INSTALL(FILES ${INCLUDE_PUBLIC_DIR}/rd-network.h DESTINATION ${CMAKE_INSTALL_PREFIX}/include/system)
