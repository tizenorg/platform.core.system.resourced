INCLUDE_DIRECTORIES(${RESOURCED_INCLUDEDIR}
		    ${DATAUSAGE_SOURCE_DIR}/include
		    ${APP-STAT_SOURCE_DIR}/include
		    ${RESOURCED_SOURCE_DIR}
		    ${NETWORK_SOURCE_DIR}/include
            )

INCLUDE(FindPkgConfig)

SET (REQUIRES_LIST
	dlog
	vconf
	edbus
)
IF("${DATAUSAGE_MODULE}" STREQUAL "ON")
	SET(REQUIRES_LIST ${REQUIRES_LIST}
		capi-telephony-network-info)
ENDIF()

pkg_check_modules(pkgs REQUIRED ${REQUIRES_LIST})

FOREACH(flag ${pkgs_CFLAGS})
        SET(EXTRA_CFLAGS "${EXTRA_CFLAGS} ${flag}")
ENDFOREACH(flag)

SET(EXTRA_CFLAGS "${EXTRA_CFLAGS} -fPIC")
SET(CMAKE_C_FLAGS "${CMAKE_C_FLAGS} ${EXTRA_CFLAGS}")

SET(settings_HEADERS
  ${DATAUSAGE_SOURCE_DIR}/include/settings.h)

SET(settings_SOURCES
  ${DATAUSAGE_SOURCE_DIR}/settings.c)

ADD_LIBRARY(settings STATIC
  ${settings_SOURCES})

IF("${DATAUSAGE_MODULE}" STREQUAL "ON")
  SET(storage_HEADERS
    ${DATAUSAGE_SOURCE_DIR}/include/storage.h)

  SET(storage_SOURCES
    ${DATAUSAGE_SOURCE_DIR}/storage.c)

  SET(protocol-info_HEADERS
    ${NETWORK_SOURCE_DIR}/include/protocol-info.h)

  SET(protocol-info_SOURCES
    ${NETWORK_SOURCE_DIR}/protocol-info.c)

  SET(app-stat_HEADERS
    ${INCLUDE_COMMON_DIR}/app-stat.h)

  SET(app-stat_SOURCES
    ${APP-STAT_SOURCE_DIR}/app-stat.c)

  SET(net-iface_HEADERS
    ${NETWORK_SOURCE_DIR}/include/iface.h)

  SET(net-iface_SOURCES
    ${NETWORK_SOURCE_DIR}/iface.c)

  SET(roaming_HEADERS
    ${NETWORK_SOURCE_DIR}/include/roaming.h)

  SET(roaming_SOURCES
    ${NETWORK_SOURCE_DIR}/roaming.c)

  ADD_LIBRARY(protocol-info STATIC
    ${protocol-info_SOURCES} ${protocol-info_HEADERS})
  ADD_LIBRARY(storage STATIC
    ${storage_SOURCES} ${storage_HEADERS})
  TARGET_LINK_LIBRARIES(storage protocol-info roaming ${pkgs_LDFLAGS})

  ADD_LIBRARY(app-stat STATIC
    ${app-stat_SOURCES} ${app-stat_HEADERS})
  TARGET_LINK_LIBRARIES(app-stat net-iface roaming classid)

  ADD_LIBRARY(net-iface STATIC
    ${net-iface_SOURCES})

  ADD_LIBRARY(roaming STATIC
    ${roaming_SOURCES})
  TARGET_LINK_LIBRARIES(roaming ${pkgs_LDFLAGS})
ENDIF()

SET(classid_HEADERS
  ${APP-STAT_SOURCE_DIR}/include/classid-helper.h)

SET(classid_SOURCES
  ${APP-STAT_SOURCE_DIR}/classid-helper.c)

ADD_LIBRARY(classid STATIC
  ${classid_SOURCES})
